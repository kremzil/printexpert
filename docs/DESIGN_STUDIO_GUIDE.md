# Design Studio — практический гайд

Дата: 2026-02-20

## Для чего этот гайд

Документ для контент-менеджера/админа: как настроить Design Studio у товара и как подготовить многостраничные шаблоны (например, лицевая + оборотная сторона визитки).

---

## 1. Быстрый сценарий (5 шагов)

1. Откройте товар в админке: `/admin/products/[id]` → вкладка `Design Studio`.
2. Включите `designerEnabled`.
3. Создайте минимум один профиль canvas и привяжите его к значению `Veľkosť`.
4. Добавьте шаблон:
   - пустой на `N` страниц, или
   - импортируйте один/несколько SVG.
5. Проверьте товар на витрине: выберите размер и откройте дизайнер.

---

## 2. Настройка профиля canvas

В блоке профилей задаются:
- `Veľkosť` (привязка к конкретному значению атрибута);
- `Trim` (ширина/высота в мм);
- `Bleed` (Top/Right/Bottom/Left, мм);
- `Safe zóna` (Top/Right/Bottom/Left, мм);
- `DPI`, `Farba pozadia`, `Farebný profil`, `Aktívny profil`.

Важно:
- один размер `Veľkosť` нельзя привязать к двум профилям;
- если для выбранного размера профиля нет, на витрине кнопка дизайнера не показывается;
- если у товара нет size-select (`smatrix-size`), профили для витрины не активируются.

---

## 3. Создание шаблонов

## Вариант A: пустой шаблон на N страниц

В блоке `Šablóny`:
1. Введите имя в поле `Nová prázdna šablóna`.
2. В поле `Strán` укажите количество страниц.
3. Нажмите `Pridať`.

Шаблон создается сразу в многостраничном формате (`pages`).

## Вариант B: импорт SVG (1+ файлов)

1. Нажмите `Import SVG (1+)`.
2. Выберите один или несколько `.svg` файлов.
3. Каждый файл будет отдельной страницей шаблона.

Система покажет отчет:
- сколько страниц импортировано;
- сколько элементов распознано;
- сколько пропущено;
- использован ли fallback.

---

## 4. Что поддерживается в SVG

Поддерживаемые элементы:
- `text`
- `rect`
- `circle`
- `ellipse`
- `image`

Неподдерживаемые элементы:
- пропускаются;
- если после парсинга нет editable-элементов, создается fallback (locked image из исходного SVG), чтобы шаблон все равно был применим.

Ограничения:
- только `.svg`;
- размер файла до 5 MB;
- скрипты/небезопасные части SVG отсекаются при импорте.

---

## 5. Как это работает на витрине

1. Пользователь выбирает `Veľkosť`.
2. Система находит профиль canvas по `(sizeAid, sizeTermId)`.
3. Если профиль найден, показывается `Otvoriť dizajnér`.
4. В редакторе:
   - геометрия в мм;
   - видны bleed/trim/safe линии;
   - можно добавлять/удалять страницы (`+ Strana`, `Odstrániť`).
5. При применении шаблона подгружаются все страницы шаблона.

---

## 6. Проверка перед публикацией

Чеклист:
- Для каждого используемого размера `Veľkosť` есть активный профиль.
- В профиле корректные мм-параметры trim/bleed/safe.
- Есть default-шаблон (по необходимости).
- SVG-шаблоны открываются в редакторе без потери критичных элементов.
- Экспорт PDF содержит все страницы.

---

## 7. Частые проблемы

## Кнопка дизайнера не видна

Проверьте:
- включен ли `designerEnabled`;
- выбран ли размер `Veľkosť`;
- существует ли активный профиль для этого размера.

## Шаблон импортировался, но «всё картинкой»

Это fallback режим. Значит SVG содержит элементы, которые не конвертируются в editable-слои.  
Решение: упростить SVG (перевести сложные эффекты в базовые `text/rect/circle/ellipse/image`).

## После смены размера дизайн пропал

Это ожидаемо: при смене на другой профиль система предлагает сбросить текущий дизайн, чтобы не смешивать разные размеры и зоны печати.

---

## 8. Связанные документы

- Техническая спецификация: `docs/DESIGN_STUDIO.md`
- Общий статус проекта: `docs/STATUS.md`
