# –û–¢–ß–ï–¢ –ü–û –ê–£–î–ò–¢–£ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò –ò –ü–†–û–í–ï–†–ö–ï –ù–ê –û–®–ò–ë–ö–ò
## –ü—Ä–æ–µ–∫—Ç: PRINTEXPERT-NEXT/web

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 25 —è–Ω–≤–∞—Ä—è 2026  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 25 —è–Ω–≤–∞—Ä—è 2026 (–º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ NextAuth v5)  
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** 0.1.7  
**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Next.js 16.1.2, React 19.2.3, PostgreSQL 16, Prisma 7.3.0, NextAuth v5 (beta)

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò

### 1. ‚úÖ **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞—Ö** ‚Üí –ò–°–ü–†–ê–í–õ–ï–ù–û
**–°—Ç–∞—Ç—É—Å:** –†–ï–®–ï–ù–û (25.01.2026)

**–†–µ—à–µ–Ω–∏–µ:**
- –í–Ω–µ–¥—Ä—ë–Ω **NextAuth v5** —Å —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª—å—é (`UserRole`: USER, ADMIN)
- Middleware –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ `authorized` callback –≤ `auth.config.ts`:
  - `/admin/*` ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/auth` –±–µ–∑ ADMIN —Ä–æ–ª–∏
  - `/account/*` ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/auth` –±–µ–∑ —Å–µ—Å—Å–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã helpers –≤ `lib/auth-helpers.ts`:
  - `requireAuth()` ‚Äî —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `requireAdmin()` ‚Äî —Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å ADMIN

**–ó–∞—â–∏—â—ë–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `app/admin/page.tsx` ‚Äî –≤—ã–∑–æ–≤ `requireAdmin()`
- `app/admin/products/[id]/page.tsx` ‚Äî –≤—ã–∑–æ–≤ `requireAdmin()`
- `app/admin/kategorie/page.tsx` ‚Äî –≤—ã–∑–æ–≤ `requireAdmin()`
- `app/admin/vlastnosti/page.tsx` ‚Äî –≤—ã–∑–æ–≤ `requireAdmin()`

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –±–µ–∑ —Å–µ—Å—Å–∏–∏ ‚Üí 302 redirect –Ω–∞ `/auth`
- –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ —Å —Ä–æ–ª—å—é USER ‚Üí 403 Forbidden

---

### 2. ‚úÖ **–ù–µ–∑–∞—â–∏—â–µ–Ω–Ω—ã–π API –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤** ‚Üí –ò–°–ü–†–ê–í–õ–ï–ù–û
**–°—Ç–∞—Ç—É—Å:** –†–ï–®–ï–ù–û (25.01.2026)

**–†–µ—à–µ–Ω–∏–µ:**
- `app/api/uploads/route.ts` —Ç—Ä–µ–±—É–µ—Ç –∞–∫—Ç–∏–≤–Ω—É—é —Å–µ—Å—Å–∏—é
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `auth()` –∏–∑ NextAuth

**–ö–æ–¥:**
```typescript
export async function POST(request: Request) {
  const session = await auth()
  if (!session?.user) {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 })
  }
  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ó–∞–≥—Ä—É–∑–∫–∞ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ‚Üí 401 Unauthorized
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å —Å–µ—Å—Å–∏–µ–π ‚Üí 200 OK

---

### 3. ‚úÖ **Server Actions –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** ‚Üí –ò–°–ü–†–ê–í–õ–ï–ù–û
**–°—Ç–∞—Ç—É—Å:** –†–ï–®–ï–ù–û (25.01.2026)

**–†–µ—à–µ–Ω–∏–µ:**
- –í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ server actions –∑–∞—â–∏—â–µ–Ω—ã —á–µ—Ä–µ–∑ `requireAdmin()`

**–ó–∞—â–∏—â—ë–Ω–Ω—ã–µ actions:**
- `app/admin/products/[id]/actions.ts`:
  - `updateProductDetails`
  - `deleteMatrix`
  - `createMatrix`
- `app/admin/kategorie/actions.ts`:
  - `createCategory`
  - `updateCategory`
  - `deleteCategory`
- `app/admin/vlastnosti/actions.ts`:
  - `createAttribute`
  - `deleteAttribute`
  - `createAttributeValue`
  - `deleteAttributeValue`

**–ö–æ–¥ (–ø—Ä–∏–º–µ—Ä):**
```typescript
"use server"
import { requireAdmin } from "@/lib/auth-helpers"

export async function updateProductDetails(formData: FormData) {
  await requireAdmin() // 403 –µ—Å–ª–∏ –Ω–µ ADMIN
  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –í—ã–∑–æ–≤ action –±–µ–∑ —Å–µ—Å—Å–∏–∏ ‚Üí redirect –Ω–∞ `/auth`
- –í—ã–∑–æ–≤ action —Å USER —Ä–æ–ª—å—é ‚Üí 403 Forbidden

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò (–æ—Å—Ç–∞–ª–∏—Å—å)

## üü† –í–´–°–û–ö–ò–ô –†–ò–°–ö

### 4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ dangerouslySetInnerHTML –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –í–´–°–û–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- HTML –∫–æ–Ω—Ç–µ–Ω—Ç –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `dangerouslySetInnerHTML` –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ç–æ–≤–∞—Ä–∞
- –•–æ—Ç—è –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è `sanitizeHtml`, –æ–Ω–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ø–∞–ª–∏ –≤ –ë–î –±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ ‚Äî —Ä–∏—Å–∫ XSS

**–§–∞–π–ª:** `app/product/[slug]/page.tsx` (—Å—Ç—Ä–æ–∫–∏ 142, 176)

**–ù–∞–π–¥–µ–Ω–Ω—ã–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è:**
```tsx
<div dangerouslySetInnerHTML={{ __html: product.excerpt }} />
<div dangerouslySetInnerHTML={{ __html: descriptionHtml }} />
```

**–¢–µ–∫—É—â–∞—è –∑–∞—â–∏—Ç–∞:**
- –§—É–Ω–∫—Ü–∏—è `sanitizeHtml` –≤ `lib/sanitize-html.ts` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —Ç–µ–≥–æ–≤
- Whitelist —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö —Ç–µ–≥–æ–≤
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ —Å—Ç–∏–ª–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ URL –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—Ç–æ–ª—å–∫–æ `https://` –∏ `/uploads/`)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –í–°–ï –ø—É—Ç–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è HTML –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ `sanitizeHtml`
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –∏–∑ –ë–î (–¥–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞)
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DOMPurify –¥–ª—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–π —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏

---

### 5. **Rate Limiting —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –í–´–°–û–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Rate limiting –¥–ª—è contact form –∏ magic link –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Map` –≤ –ø–∞–º—è—Ç–∏
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ —Å—á–µ—Ç—á–∏–∫–∏ –æ–±–Ω—É–ª—è—é—Ç—Å—è
- –í —Ä–µ–∂–∏–º–µ standalone Next.js –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–§–∞–π–ª—ã:**
- `app/api/contact/route.ts` (—Å—Ç—Ä–æ–∫–∞ 15)
- `app/api/auth/magic/route.ts` (—Å—Ç—Ä–æ–∫–∞ 17)

**–ö–æ–¥:**
```typescript
const rateLimitStore = new Map<string, { count: number; resetAt: number }>()
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è rate limit
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: —Ö—Ä–∞–Ω–∏—Ç—å –≤ PostgreSQL —Å –∏–Ω–¥–µ–∫—Å–æ–º –ø–æ IP
- –î–æ–±–∞–≤–∏—Ç—å –æ—á–∏—Å—Ç–∫—É —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π –∏–∑ Map

---

### 6. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSRF –∑–∞—â–∏—Ç—ã**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –í–´–°–û–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- POST –∑–∞–ø—Ä–æ—Å—ã –∫ API –Ω–µ –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç CSRF –∞—Ç–∞–∫
- Cookie `session` –∏–º–µ–µ—Ç `sameSite: "lax"`, —á—Ç–æ —á–∞—Å—Ç–∏—á–Ω–æ –∑–∞—â–∏—â–∞–µ—Ç
- –ù–æ –¥–ª—è –ø–æ–ª–Ω–æ–π –∑–∞—â–∏—Ç—ã –Ω—É–∂–µ–Ω CSRF —Ç–æ–∫–µ–Ω

**–§–∞–π–ª—ã:**
- –í—Å–µ POST endpoints –≤ `app/api/`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```typescript
// –î–æ–±–∞–≤–∏—Ç—å middleware —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π CSRF —Ç–æ–∫–µ–Ω–∞
// –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ X-CSRF-Token –≤ –∫–∞–∂–¥–æ–º POST –∑–∞–ø—Ä–æ—Å–µ
```

---

## üü° –°–†–ï–î–ù–ò–ô –†–ò–°–ö

### 7. **–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –°–†–ï–î–ù–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- SMTP credentials —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `.env`
- DATABASE_URL –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
- –ù–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ secrets management

**–§–∞–π–ª—ã:**
- `.env.example`
- `.env.production.example`

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
```env
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/shop?schema=public"
SMTP_USER="user@example.com"
SMTP_PASS="password"
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ–∫—Ä–µ—Ç—ã Docker/Kubernetes –¥–ª—è production
- –ù–µ –∫–æ–º–º–∏—Ç–∏—Ç—å `.env` —Ñ–∞–π–ª—ã (—É–∂–µ –≤ `.gitignore` ‚úÖ)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AWS Secrets Manager –∏–ª–∏ HashiCorp Vault

---

### 8. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –°–†–ï–î–ù–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ —Ç–æ–ª—å–∫–æ –ø–æ `file.type` –∏–∑ formData
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å MIME-type

**–§–∞–π–ª:** `app/api/uploads/route.ts` (—Å—Ç—Ä–æ–∫–∞ 53)

```typescript
const contentType = file.type
const isImage = allowedImageTypes.has(contentType)
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```typescript
// –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É magic bytes (file signature)
import { fileTypeFromBuffer } from 'file-type'

const buffer = Buffer.from(await file.arrayBuffer())
const fileType = await fileTypeFromBuffer(buffer)
if (!fileType || !allowedImageTypes.has(fileType.mime)) {
  return error
}
```

---

### 9. **SQL Injection –∑–∞—â–∏—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç Prisma**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –°–†–ï–î–ù–ò–ô (–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ü—Ä—è–º—ã—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ Prisma Client
- Prisma –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫:**
- –í `app/admin/products/[id]/actions.ts` –µ—Å—Ç—å PHP serialization/unserialization
- –ù–µ—Ç raw SQL, –Ω–æ –µ—Å—Ç—å —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Prisma –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ù–µ –¥–æ–±–∞–≤–ª—è—Ç—å `prisma.$executeRaw` –±–µ–∑ –∫—Ä–∞–π–Ω–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ raw SQL –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—é

---

### 10. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –°–†–ï–î–ù–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- –ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö –≤ –∞–¥–º–∏–Ω–∫–µ
- –¢–æ–ª—å–∫–æ `console.error()` –¥–ª—è –æ—à–∏–±–æ–∫

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```typescript
// –î–æ–±–∞–≤–∏—Ç—å structured logging
import winston from 'winston'

logger.info({
  event: 'admin_product_update',
  userId: session.userId,
  productId,
  changes: diff,
  timestamp: new Date()
})
```

---

## üü¢ –ù–ò–ó–ö–ò–ô –†–ò–°–ö / –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### 11. **–û—Ç–∫—Ä—ã—Ç—ã–µ API endpoints –±–µ–∑ throttling**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –ù–ò–ó–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `POST /api/price` –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è DDoS

**–§–∞–π–ª:** `app/api/price/route.ts`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –î–æ–±–∞–≤–∏—Ç—å rate limiting
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

---

### 12. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Content Security Policy**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –ù–ò–ó–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç CSP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∏—Å–∫ XSS –∞—Ç–∞–∫

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```typescript
// –í next.config.ts –¥–æ–±–∞–≤–∏—Ç—å:
async headers() {
  return [
    {
      source: '/:path*',
      headers: [
        {
          key: 'Content-Security-Policy',
          value: "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';"
        }
      ]
    }
  ]
}
```

---

### 13. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –ù–ò–ó–ö–ò–ô

**–§–∞–π–ª:** `app/api/uploads/route.ts` (—Å—Ç—Ä–æ–∫–∞ 19)

```typescript
const sanitizeFileName = (name: string) =>
  name.replace(/[^a-z0-9._-]/gi, "_").toLowerCase()
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –î–æ–±–∞–≤–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ (max 255 —Å–∏–º–≤–æ–ª–æ–≤)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

---

## ‚úÖ –•–û–†–û–®–ò–ï –ü–†–ê–ö–¢–ò–ö–ò (–Ω–∞–π–¥–µ–Ω–Ω—ã–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ)

1. **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π —á–µ—Ä–µ–∑ scrypt** ‚úÖ
   - `lib/auth.ts` (—Å—Ç—Ä–æ–∫–∏ 30-36)
   - –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–æ–ª—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä–æ–ª—è

2. **HttpOnly cookies –¥–ª—è —Å–µ—Å—Å–∏–π** ‚úÖ
   - `lib/auth.ts` (—Å—Ç—Ä–æ–∫–∏ 94-101)
   - `sameSite: "lax"`, `secure` –≤ production

3. **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ë–î** ‚úÖ
   - Session tokens —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ SHA-256 —Ö–µ—à–∏
   - Raw —Ç–æ–∫–µ–Ω—ã —Ç–æ–ª—å–∫–æ –≤ cookies

4. **–í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ Zod** ‚úÖ
   - –í—Å–µ API endpoints –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   - –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

5. **Honeypot –≤ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–π —Ñ–æ—Ä–º–µ** ‚úÖ
   - `app/api/contact/route.ts` (—Å—Ç—Ä–æ–∫–∏ 59-64)
   - –ü–æ–ª–µ `company` –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±–æ—Ç–æ–≤

6. **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è HTML** ‚úÖ
   - `lib/sanitize-html.ts`
   - Whitelist —Ç–µ–≥–æ–≤ –∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤

7. **TypeScript strict mode** ‚úÖ
   - `tsconfig.json` (—Å—Ç—Ä–æ–∫–∞ 6)
   - –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è

8. **Prisma –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç SQL Injection** ‚úÖ
   - –ù–µ—Ç raw SQL –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–†–û–í–ï–†–ö–ò

- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:** 3
- **–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫:** 3
- **–°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫:** 4
- **–ù–∏–∑–∫–∏–π —Ä–∏—Å–∫:** 3
- **–•–æ—Ä–æ—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:** 8

---

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢–ù–´–ô –ü–õ–ê–ù –£–°–¢–†–ê–ù–ï–ù–ò–Ø

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (–≤ —Ç–µ—á–µ–Ω–∏–µ 1-2 –¥–Ω–µ–π):
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ –≤—Å–µ—Ö `/admin/*` –º–∞—Ä—à—Ä—É—Ç–∞—Ö
2. ‚úÖ –ó–∞—â–∏—Ç–∏—Ç—å `/api/uploads` –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–µ—Å—Å–∏–∏
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –≤–æ –≤—Å–µ server actions

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ (1-2 –Ω–µ–¥–µ–ª–∏):
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Ä–æ–ª–µ–π (User, Admin)
5. –î–æ–±–∞–≤–∏—Ç—å CSRF –∑–∞—â–∏—Ç—É
6. –ó–∞–º–µ–Ω–∏—Ç—å in-memory rate limiting –Ω–∞ Redis/PostgreSQL
7. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ñ–∞–π–ª–æ–≤ –ø–æ magic bytes
8. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å structured logging

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–æ (1 –º–µ—Å—è—Ü):
9. –í–Ω–µ–¥—Ä–∏—Ç—å Content Security Policy
10. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å secrets management –¥–ª—è production
11. –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
12. –ü—Ä–æ–≤–µ—Å—Ç–∏ penetration testing

---

## üìã –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### Docker –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- ‚úÖ Multi-stage build –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ Non-root user –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ `Dockerfile`
- ‚ö†Ô∏è –í `docker-compose.yml` –ø–∞—Ä–æ–ª–∏ –ë–î –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- Next.js 16.1.2 ‚Äî –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è ‚úÖ
- React 19.2.3 ‚Äî –Ω–æ–≤–µ–π—à–∞—è –≤–µ—Ä—Å–∏—è ‚úÖ
- Prisma 7.3.0 ‚Äî –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è ‚úÖ
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:** —Ä–µ–≥—É–ª—è—Ä–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å `npm audit`

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
- –•–æ—Ä–æ—à–µ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ server/client components ‚úÖ
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `"use cache"` –∏ `cacheTag` ‚úÖ
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `"use server"` –¥–ª—è actions ‚úÖ

---

## üîí –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

**–ò—Å—Ö–æ–¥–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å (–¥–æ –º–∏–≥—Ä–∞—Ü–∏–∏):** üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô**

**–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å (–ø–æ—Å–ª–µ NextAuth v5):** üü° **–£–î–û–í–õ–ï–¢–í–û–†–ò–¢–ï–õ–¨–ù–´–ô**

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ –ê–¥–º–∏–Ω–∫–∞ –∑–∞—â–∏—â–µ–Ω–∞ middleware + requireAdmin()
- ‚úÖ Upload API —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
- ‚úÖ Server actions –∑–∞—â–∏—â–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ä–æ–ª–∏
- ‚úÖ –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (USER, ADMIN)
- ‚úÖ JWT —Å–µ—Å—Å–∏–∏ —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ cookies

**–û—Å—Ç–∞—ë—Ç—Å—è:**
- ‚ö†Ô∏è Rate limiting –≤ –ø–∞–º—è—Ç–∏ (–Ω—É–∂–µ–Ω Redis)
- ‚ö†Ô∏è –ù–µ—Ç CSRF —Ç–æ–∫–µ–Ω–æ–≤ (—á–∞—Å—Ç–∏—á–Ω–æ –∑–∞—â–∏—â–µ–Ω–æ sameSite)
- ‚ö†Ô∏è Secrets –≤ .env (–Ω—É–∂–µ–Ω secrets manager –¥–ª—è production)
- ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ —Ç–æ–ª—å–∫–æ –ø–æ MIME-type

**–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è üü¢ –ü–†–ò–ï–ú–õ–ï–ú–´–ô:**
1. –í–Ω–µ–¥—Ä–∏—Ç—å Redis –¥–ª—è rate limiting
2. –î–æ–±–∞–≤–∏—Ç—å CSRF protection
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å secrets manager –≤ production
4. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É magic bytes –¥–ª—è –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
5. –ü—Ä–æ–≤–µ—Å—Ç–∏ penetration testing

---

## üìù –ü–†–ò–ú–ï–ß–ê–ù–ò–Ø

- –ê—É–¥–∏—Ç –ø—Ä–æ–≤–µ–¥—ë–Ω: 25 —è–Ω–≤–∞—Ä—è 2026
- –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ NextAuth v5 –∑–∞–≤–µ—Ä—à–µ–Ω–∞: 25 —è–Ω–≤–∞—Ä—è 2026
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Å—Ç–∏ —Ä—É—á–Ω–æ–π penetration testing –ø–µ—Ä–µ–¥ production deployment
- –°–ª–µ–¥—É–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`npm audit`)
- –ù–µ–æ–±—Ö–æ–¥–∏–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ production

---

## üéØ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô –î–õ–Ø PRODUCTION

### –î–æ –∑–∞–ø—É—Å–∫–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):
1. ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ NextAuth v5 ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
2. ‚úÖ –ó–∞—â–∏—Ç–∞ –∞–¥–º–∏–Ω–∫–∏ ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
3. ‚úÖ –ó–∞—â–∏—Ç–∞ upload API ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
4. ‚úÖ –ó–∞—â–∏—Ç–∞ server actions ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
5. ‚è≥ –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ Prisma Studio
6. ‚è≥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMTP –¥–ª—è production
7. ‚è≥ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å `NEXTAUTH_SECRET` —á–µ—Ä–µ–∑ `openssl rand -base64 32`
8. ‚è≥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `NEXTAUTH_URL` –¥–ª—è production –¥–æ–º–µ–Ω–∞

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º:
9. Redis –¥–ª—è rate limiting –∏ —Å–µ—Å—Å–∏–π
10. CSRF protection –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints
11. Secrets manager (AWS/Vault) –≤–º–µ—Å—Ç–æ .env
12. –ü—Ä–æ–≤–µ—Ä–∫–∞ magic bytes –¥–ª—è —Ñ–∞–π–ª–æ–≤
13. WAF (Web Application Firewall)
14. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Sentry, DataDog)

### –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:
15. –†–µ–≥—É–ª—è—Ä–Ω—ã–π `npm audit` + –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
16. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
17. Quarterly penetration testing
18. Security headers audit (CSP, HSTS, etc.)

---

**–ö–æ–Ω–µ—Ü –æ—Ç—á–µ—Ç–∞**
