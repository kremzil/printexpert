# –û–¢–ß–ï–¢ –ü–û –ê–£–î–ò–¢–£ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò –ò –ü–†–û–í–ï–†–ö–ï –ù–ê –û–®–ò–ë–ö–ò
## –ü—Ä–æ–µ–∫—Ç: PRINTEXPERT-NEXT/web

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 25 —è–Ω–≤–∞—Ä—è 2026  
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** 0.1.7  
**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Next.js 16.1.2, React 19.2.3, PostgreSQL 16, Prisma 7.3.0

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò

### 1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞—Ö**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í—Å–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:
  - `/admin` ‚Äî —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
  - `/admin/products/[id]` ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –∏ –º–∞—Ç—Ä–∏—Ü —Ü–µ–Ω
  - `/admin/kategorie` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
  - `/admin/vlastnosti` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –õ—é–±–æ–π –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω–∫–µ
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤, –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —Ü–µ–Ω
- –ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤

**–§–∞–π–ª—ã:**
- `app/admin/page.tsx`
- `app/admin/products/[id]/page.tsx`
- `app/admin/kategorie/page.tsx`
- `app/admin/vlastnosti/page.tsx`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```typescript
// –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–∞–∂–¥—É—é –∞–¥–º–∏–Ω—Å–∫—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É:
import { getSessionFromCookies } from "@/lib/auth"
import { redirect } from "next/navigation"

async function checkAdmin() {
  const session = await getSessionFromCookies()
  if (!session) {
    redirect("/auth")
  }
  // TODO: –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–æ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
  // if (!session.user.isAdmin) redirect("/")
}
```

---

### 2. **–ù–µ–∑–∞—â–∏—â–µ–Ω–Ω—ã–π API –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Endpoint `POST /api/uploads` –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –õ—é–±–æ–π –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–∞–π–ª—ã –≤ `/public/uploads/`
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

**–§–∞–π–ª:** `app/api/uploads/route.ts`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```typescript
export async function POST(request: Request) {
  // –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å–µ—Å—Å–∏–∏
  const session = await getSessionFromRequest(request)
  if (!session) {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 })
  }
  
  // –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥...
}
```

---

### 3. **Server Actions –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í—Å–µ server actions –≤ –∞–¥–º–∏–Ω–∫–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤:
  - `updateProductDetails` ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
  - `deleteMatrix` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü —Ü–µ–Ω
  - `createCategory` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
  - `deleteCategory` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

**–§–∞–π–ª—ã:**
- `app/admin/products/[id]/actions.ts`
- `app/admin/kategorie/actions.ts`
- `app/admin/vlastnosti/actions.ts`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```typescript
"use server"

import { getSessionFromCookies } from "@/lib/auth"

export async function updateProductDetails(formData: FormData) {
  const session = await getSessionFromCookies()
  if (!session) {
    throw new Error("Unauthorized")
  }
  // –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥...
}
```

---

## üü† –í–´–°–û–ö–ò–ô –†–ò–°–ö

### 4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ dangerouslySetInnerHTML –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –í–´–°–û–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- HTML –∫–æ–Ω—Ç–µ–Ω—Ç –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `dangerouslySetInnerHTML` –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ç–æ–≤–∞—Ä–∞
- –•–æ—Ç—è –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è `sanitizeHtml`, –æ–Ω–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ø–∞–ª–∏ –≤ –ë–î –±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ ‚Äî —Ä–∏—Å–∫ XSS

**–§–∞–π–ª:** `app/product/[slug]/page.tsx` (—Å—Ç—Ä–æ–∫–∏ 142, 176)

**–ù–∞–π–¥–µ–Ω–Ω—ã–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è:**
```tsx
<div dangerouslySetInnerHTML={{ __html: product.excerpt }} />
<div dangerouslySetInnerHTML={{ __html: descriptionHtml }} />
```

**–¢–µ–∫—É—â–∞—è –∑–∞—â–∏—Ç–∞:**
- –§—É–Ω–∫—Ü–∏—è `sanitizeHtml` –≤ `lib/sanitize-html.ts` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —Ç–µ–≥–æ–≤
- Whitelist —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö —Ç–µ–≥–æ–≤
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ —Å—Ç–∏–ª–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ URL –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—Ç–æ–ª—å–∫–æ `https://` –∏ `/uploads/`)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –í–°–ï –ø—É—Ç–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è HTML –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ `sanitizeHtml`
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –∏–∑ –ë–î (–¥–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞)
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DOMPurify –¥–ª—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–π —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏

---

### 5. **Rate Limiting —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –í–´–°–û–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Rate limiting –¥–ª—è contact form –∏ magic link –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Map` –≤ –ø–∞–º—è—Ç–∏
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ —Å—á–µ—Ç—á–∏–∫–∏ –æ–±–Ω—É–ª—è—é—Ç—Å—è
- –í —Ä–µ–∂–∏–º–µ standalone Next.js –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–§–∞–π–ª—ã:**
- `app/api/contact/route.ts` (—Å—Ç—Ä–æ–∫–∞ 15)
- `app/api/auth/magic/route.ts` (—Å—Ç—Ä–æ–∫–∞ 17)

**–ö–æ–¥:**
```typescript
const rateLimitStore = new Map<string, { count: number; resetAt: number }>()
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è rate limit
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: —Ö—Ä–∞–Ω–∏—Ç—å –≤ PostgreSQL —Å –∏–Ω–¥–µ–∫—Å–æ–º –ø–æ IP
- –î–æ–±–∞–≤–∏—Ç—å –æ—á–∏—Å—Ç–∫—É —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π –∏–∑ Map

---

### 6. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSRF –∑–∞—â–∏—Ç—ã**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –í–´–°–û–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- POST –∑–∞–ø—Ä–æ—Å—ã –∫ API –Ω–µ –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç CSRF –∞—Ç–∞–∫
- Cookie `session` –∏–º–µ–µ—Ç `sameSite: "lax"`, —á—Ç–æ —á–∞—Å—Ç–∏—á–Ω–æ –∑–∞—â–∏—â–∞–µ—Ç
- –ù–æ –¥–ª—è –ø–æ–ª–Ω–æ–π –∑–∞—â–∏—Ç—ã –Ω—É–∂–µ–Ω CSRF —Ç–æ–∫–µ–Ω

**–§–∞–π–ª—ã:**
- –í—Å–µ POST endpoints –≤ `app/api/`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```typescript
// –î–æ–±–∞–≤–∏—Ç—å middleware —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π CSRF —Ç–æ–∫–µ–Ω–∞
// –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ X-CSRF-Token –≤ –∫–∞–∂–¥–æ–º POST –∑–∞–ø—Ä–æ—Å–µ
```

---

## üü° –°–†–ï–î–ù–ò–ô –†–ò–°–ö

### 7. **–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –°–†–ï–î–ù–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- SMTP credentials —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `.env`
- DATABASE_URL –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
- –ù–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ secrets management

**–§–∞–π–ª—ã:**
- `.env.example`
- `.env.production.example`

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
```env
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/shop?schema=public"
SMTP_USER="user@example.com"
SMTP_PASS="password"
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ–∫—Ä–µ—Ç—ã Docker/Kubernetes –¥–ª—è production
- –ù–µ –∫–æ–º–º–∏—Ç–∏—Ç—å `.env` —Ñ–∞–π–ª—ã (—É–∂–µ –≤ `.gitignore` ‚úÖ)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AWS Secrets Manager –∏–ª–∏ HashiCorp Vault

---

### 8. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –°–†–ï–î–ù–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ —Ç–æ–ª—å–∫–æ –ø–æ `file.type` –∏–∑ formData
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å MIME-type

**–§–∞–π–ª:** `app/api/uploads/route.ts` (—Å—Ç—Ä–æ–∫–∞ 53)

```typescript
const contentType = file.type
const isImage = allowedImageTypes.has(contentType)
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```typescript
// –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É magic bytes (file signature)
import { fileTypeFromBuffer } from 'file-type'

const buffer = Buffer.from(await file.arrayBuffer())
const fileType = await fileTypeFromBuffer(buffer)
if (!fileType || !allowedImageTypes.has(fileType.mime)) {
  return error
}
```

---

### 9. **SQL Injection –∑–∞—â–∏—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç Prisma**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –°–†–ï–î–ù–ò–ô (–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ü—Ä—è–º—ã—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ Prisma Client
- Prisma –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫:**
- –í `app/admin/products/[id]/actions.ts` –µ—Å—Ç—å PHP serialization/unserialization
- –ù–µ—Ç raw SQL, –Ω–æ –µ—Å—Ç—å —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Prisma –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ù–µ –¥–æ–±–∞–≤–ª—è—Ç—å `prisma.$executeRaw` –±–µ–∑ –∫—Ä–∞–π–Ω–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ raw SQL –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—é

---

### 10. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –°–†–ï–î–ù–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- –ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö –≤ –∞–¥–º–∏–Ω–∫–µ
- –¢–æ–ª—å–∫–æ `console.error()` –¥–ª—è –æ—à–∏–±–æ–∫

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```typescript
// –î–æ–±–∞–≤–∏—Ç—å structured logging
import winston from 'winston'

logger.info({
  event: 'admin_product_update',
  userId: session.userId,
  productId,
  changes: diff,
  timestamp: new Date()
})
```

---

## üü¢ –ù–ò–ó–ö–ò–ô –†–ò–°–ö / –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### 11. **–û—Ç–∫—Ä—ã—Ç—ã–µ API endpoints –±–µ–∑ throttling**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –ù–ò–ó–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `POST /api/price` –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è DDoS

**–§–∞–π–ª:** `app/api/price/route.ts`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –î–æ–±–∞–≤–∏—Ç—å rate limiting
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

---

### 12. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Content Security Policy**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –ù–ò–ó–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç CSP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∏—Å–∫ XSS –∞—Ç–∞–∫

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```typescript
// –í next.config.ts –¥–æ–±–∞–≤–∏—Ç—å:
async headers() {
  return [
    {
      source: '/:path*',
      headers: [
        {
          key: 'Content-Security-Policy',
          value: "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';"
        }
      ]
    }
  ]
}
```

---

### 13. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞**
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:** –ù–ò–ó–ö–ò–ô

**–§–∞–π–ª:** `app/api/uploads/route.ts` (—Å—Ç—Ä–æ–∫–∞ 19)

```typescript
const sanitizeFileName = (name: string) =>
  name.replace(/[^a-z0-9._-]/gi, "_").toLowerCase()
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –î–æ–±–∞–≤–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ (max 255 —Å–∏–º–≤–æ–ª–æ–≤)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

---

## ‚úÖ –•–û–†–û–®–ò–ï –ü–†–ê–ö–¢–ò–ö–ò (–Ω–∞–π–¥–µ–Ω–Ω—ã–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ)

1. **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π —á–µ—Ä–µ–∑ scrypt** ‚úÖ
   - `lib/auth.ts` (—Å—Ç—Ä–æ–∫–∏ 30-36)
   - –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–æ–ª—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä–æ–ª—è

2. **HttpOnly cookies –¥–ª—è —Å–µ—Å—Å–∏–π** ‚úÖ
   - `lib/auth.ts` (—Å—Ç—Ä–æ–∫–∏ 94-101)
   - `sameSite: "lax"`, `secure` –≤ production

3. **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ë–î** ‚úÖ
   - Session tokens —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ SHA-256 —Ö–µ—à–∏
   - Raw —Ç–æ–∫–µ–Ω—ã —Ç–æ–ª—å–∫–æ –≤ cookies

4. **–í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ Zod** ‚úÖ
   - –í—Å–µ API endpoints –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   - –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

5. **Honeypot –≤ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–π —Ñ–æ—Ä–º–µ** ‚úÖ
   - `app/api/contact/route.ts` (—Å—Ç—Ä–æ–∫–∏ 59-64)
   - –ü–æ–ª–µ `company` –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±–æ—Ç–æ–≤

6. **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è HTML** ‚úÖ
   - `lib/sanitize-html.ts`
   - Whitelist —Ç–µ–≥–æ–≤ –∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤

7. **TypeScript strict mode** ‚úÖ
   - `tsconfig.json` (—Å—Ç—Ä–æ–∫–∞ 6)
   - –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è

8. **Prisma –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç SQL Injection** ‚úÖ
   - –ù–µ—Ç raw SQL –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–†–û–í–ï–†–ö–ò

- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:** 3
- **–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫:** 3
- **–°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫:** 4
- **–ù–∏–∑–∫–∏–π —Ä–∏—Å–∫:** 3
- **–•–æ—Ä–æ—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:** 8

---

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢–ù–´–ô –ü–õ–ê–ù –£–°–¢–†–ê–ù–ï–ù–ò–Ø

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (–≤ —Ç–µ—á–µ–Ω–∏–µ 1-2 –¥–Ω–µ–π):
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ –≤—Å–µ—Ö `/admin/*` –º–∞—Ä—à—Ä—É—Ç–∞—Ö
2. ‚úÖ –ó–∞—â–∏—Ç–∏—Ç—å `/api/uploads` –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–µ—Å—Å–∏–∏
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –≤–æ –≤—Å–µ server actions

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ (1-2 –Ω–µ–¥–µ–ª–∏):
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Ä–æ–ª–µ–π (User, Admin)
5. –î–æ–±–∞–≤–∏—Ç—å CSRF –∑–∞—â–∏—Ç—É
6. –ó–∞–º–µ–Ω–∏—Ç—å in-memory rate limiting –Ω–∞ Redis/PostgreSQL
7. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ñ–∞–π–ª–æ–≤ –ø–æ magic bytes
8. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å structured logging

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–æ (1 –º–µ—Å—è—Ü):
9. –í–Ω–µ–¥—Ä–∏—Ç—å Content Security Policy
10. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å secrets management –¥–ª—è production
11. –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
12. –ü—Ä–æ–≤–µ—Å—Ç–∏ penetration testing

---

## üìã –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### Docker –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- ‚úÖ Multi-stage build –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ Non-root user –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ `Dockerfile`
- ‚ö†Ô∏è –í `docker-compose.yml` –ø–∞—Ä–æ–ª–∏ –ë–î –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- Next.js 16.1.2 ‚Äî –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è ‚úÖ
- React 19.2.3 ‚Äî –Ω–æ–≤–µ–π—à–∞—è –≤–µ—Ä—Å–∏—è ‚úÖ
- Prisma 7.3.0 ‚Äî –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è ‚úÖ
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:** —Ä–µ–≥—É–ª—è—Ä–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å `npm audit`

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
- –•–æ—Ä–æ—à–µ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ server/client components ‚úÖ
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `"use cache"` –∏ `cacheTag` ‚úÖ
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `"use server"` –¥–ª—è actions ‚úÖ

---

## üîí –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

**–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å:** üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - –¢–†–ï–ë–£–ï–¢–°–Ø –ù–ï–ú–ï–î–õ–ï–ù–ù–û–ï –í–ú–ï–®–ê–¢–ï–õ–¨–°–¢–í–û**

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫—Ä—ã—Ç–∞—è –∞–¥–º–∏–Ω–∫–∞ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö

**–ü–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π:** üü° **–£–î–û–í–õ–ï–¢–í–û–†–ò–¢–ï–õ–¨–ù–´–ô**

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–ª–∞–Ω–∞:** üü¢ **–ü–†–ò–ï–ú–õ–ï–ú–´–ô**

---

## üìù –ü–†–ò–ú–ï–ß–ê–ù–ò–Ø

- –≠—Ç–æ—Ç –∞—É–¥–∏—Ç –±—ã–ª –ø—Ä–æ–≤–µ–¥–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Å—Ç–∏ —Ä—É—á–Ω–æ–π penetration testing
- –°–ª–µ–¥—É–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- –ù–µ–æ–±—Ö–æ–¥–∏–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ production

---

**–ö–æ–Ω–µ—Ü –æ—Ç—á–µ—Ç–∞**
